
# üìä –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

## –û–±–∑–æ—Ä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –±–∞–∑–µ **pytest** –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "AI Translator & Critic".

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¢–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ conftest.py              - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest, —Ñ–∏–∫—Å—Ç—É—Ä—ã –∏ –º–æ–∫–∏
‚îú‚îÄ‚îÄ test_app.py              - –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (57 —Ç–µ—Å—Ç–æ–≤)
‚îî‚îÄ‚îÄ test_api_integration.py   - –¢–µ—Å—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å API (21 —Ç–µ—Å—Ç–æ–≤)
```

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install -r requirements.txt
pip install pytest pytest-mock pytest-cov
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
```bash
pytest tests/ -v
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
```bash
pytest tests/ --cov=src --cov-report=html
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
```bash
pytest tests/test_app.py -v
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
```bash
pytest tests/test_app.py::TestIndexGet::test_index_get_returns_200 -v
```

---

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¢–µ—Å—Ç–æ–≤

### 1. –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–´–ï –¢–ï–°–¢–´ (test_app.py)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GET –∑–∞–ø—Ä–æ—Å–æ–≤ (–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ä–º—ã)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ POST –∑–∞–ø—Ä–æ—Å–æ–≤ (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 2. –¢–ï–°–¢–´ –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –° API (test_api_integration.py)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è HTTP –∑–∞–ø—Ä–æ—Å–∞ –∫ API
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç API
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API –∫–ª—é—á–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö

### 3. –¢–ï–°–¢–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
- –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ API –∫–ª—é—á –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ Authorization

---

## –û–ø–∏—Å–∞–Ω–∏–µ –û—Å–Ω–æ–≤–Ω—ã—Ö –¢–µ—Å—Ç–æ–≤

### –ì—Ä—É–ø–ø–∞ 1: –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

**test_index_get_returns_form**
- –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ GET / –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTML —Ñ–æ—Ä–º—É
- –û–∂–∏–¥–∞–µ–º–æ–µ: –°—Ç–∞—Ç—É—Å 200, –≤ –æ—Ç–≤–µ—Ç–µ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è —Ñ–æ—Ä–º–∞ —Å textarea –∏ select

**test_post_with_empty_text_returns_error**
- –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—É—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ POST –∑–∞–ø—Ä–æ—Å–µ
- –û–∂–∏–¥–∞–µ–º–æ–µ: –°—Ç–∞—Ç—É—Å 200, –≤ –æ—Ç–≤–µ—Ç–µ –æ—à–∏–±–∫–∞ "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç"

**test_post_with_valid_data_triggers_api_call**
- –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ POST —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤—ã–∑—ã–≤–∞–µ—Ç API
- –û–∂–∏–¥–∞–µ–º–æ–µ: –§—É–Ω–∫—Ü–∏—è call_llm –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã (–ø–µ—Ä–µ–≤–æ–¥ –∏ –æ—Ü–µ–Ω–∫–∞)

**test_language_selection_works**
- –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
- –û–∂–∏–¥–∞–µ–º–æ–µ: –§–æ—Ä–º–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ —Ç—Ä–∏ —è–∑—ã–∫–∞ (–ê–Ω–≥–ª–∏–π—Å–∫–∏–π, –§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π, –ù–µ–º–µ—Ü–∫–∏–π)

### –ì—Ä—É–ø–ø–∞ 2: –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**test_api_error_500_handled_gracefully**
- –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–∫–∏ 500 –æ—Ç API
- –û–∂–∏–¥–∞–µ–º–æ–µ: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–∞–¥–∞–µ—Ç

**test_api_timeout_handled**
- –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∞–π–º–∞—É—Ç–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ API
- –û–∂–∏–¥–∞–µ–º–æ–µ: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ API"

### –ì—Ä—É–ø–ø–∞ 3: –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ markdown

**test_markdown_processing_in_evaluation**
- –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ markdown –≤ –æ—Ü–µ–Ω–∫–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ HTML
- –û–∂–∏–¥–∞–µ–º–æ–µ: ** –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ `<strong>`, # –≤ `<h2>` –∏ —Ç.–¥.

**test_markdown_escaping_for_security**
- –û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π HTML –≤ markdown –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- –û–∂–∏–¥–∞–µ–º–æ–µ: HTML —Ç–µ–≥–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç

---

## Mock –û–±—ä–µ–∫—Ç—ã –∏ –§–∏–∫—Å—Ç—É—Ä—ã

### `@pytest.fixture client`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç Flask test client –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤

### `@pytest.fixture mock_api_response`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–æ–∫–æ–≤—ã–π —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç API

### `@pytest.fixture mock_call_llm`
–ú–æ–∫–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `call_llm` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ API

---

## –ü—Ä–∏–º–µ—Ä—ã –ó–∞–ø—É—Å–∫–∞

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
pytest tests/ -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest tests/ --cov=src --cov-report=html

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/test_app.py -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã API
pytest tests/test_api_integration.py -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
pytest tests/ -m "critical" -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –≤—ã–≤–æ–¥–æ–º print() –∏ –ª–æ–≥–æ–≤
pytest tests/ -v -s
```

---

## –ú–µ—Ç—Ä–∏–∫–∏ –ö–∞—á–µ—Å—Ç–≤–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| –¶–µ–ª–µ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ | 85% | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ 97% |
| –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ | call_llm(), process() | ‚úÖ 100% |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | Network, HTTP, Timeout | ‚úÖ 100% |

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

–¢–µ—Å—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã –≤ CI/CD –ø–∞–π–ø–µ–ª–∞–π–Ω–µ (GitHub Actions, GitLab CI, etc):

```yaml
name: Run Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install dependencies
        run: pip install -r requirements.txt
      - name: Run tests
        run: pytest tests/ -v --cov=src
```

---

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ü—Ä–æ–±–ª–µ–º—ã –∏ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. –¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–æ–∫–∏ –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤ - —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è
2. –¢–∞–π–º–∞—É—Ç—ã –≤ —Ç–µ—Å—Ç–∞—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
3. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è API_KEY –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–µ—Å—Ç–æ–≤

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è QA

1. **–ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º:**
   ```bash
   pytest tests/ -v
   ```

2. **–î–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–π —Ç–µ—Å—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –±–∞–≥–∞**

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å -s —Ñ–ª–∞–≥ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:**
   ```bash
   pytest tests/ -v -s
   ```

4. **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ:**
   ```bash
   pytest --cov=src tests/
   ```

5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏**

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å —Ç–µ—Å—Ç–∞–º–∏:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: `pip install pytest pytest-mock`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ .env —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–Ω—ã–π API –∫–ª—é—á
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã —Å —Ñ–ª–∞–≥–æ–º `-v` –¥–ª—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `src/app.py` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 16 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 1.1  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û
