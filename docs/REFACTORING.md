# üîß –û—Ç—á–µ—Ç –æ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–î–∞—Ç–∞:** 16 –¥–µ–∫–∞–±—Ä—è 2025

---

## –ò—Ç–æ–≥–∏ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ö–æ–¥–∞ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è (src/app.py)

#### –ë—ã–ª–æ
- 255 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –ü–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤
- –§—É–Ω–∫—Ü–∏—è `process()` –±—ã–ª–∞ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–π (167 —Å—Ç—Ä–æ–∫)

#### –°—Ç–∞–ª–æ
- **139 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ (-45% —Å—Ç—Ä–æ–∫)**
- –õ–∞–∫–æ–Ω–∏—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- –ò–∑–≤–ª–µ—á–µ–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥

#### –£–ª—É—á—à–µ–Ω–∏—è

```python
# –î–û: –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏
translation_prompt = f"–ü–µ—Ä–µ–≤–µ–¥–∏... {original_text}"
translated_text = call_llm("Qwen/...", prompt)

judge_prompt = f"–û—Ü–µ–Ω–∏... {translated_text}"
evaluation = call_llm("claude-...", prompt)

# –ü–û–°–õ–ï: –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
def _build_translation_prompt(text, language):
    return f"–ü–µ—Ä–µ–≤–µ–¥–∏... {text}"

def _build_evaluation_prompt(original, translated, language):
    return f"–û—Ü–µ–Ω–∏... {translated}"

def _process_translation(text, language):
    return call_llm(TRANSLATOR_MODEL, _build_translation_prompt(text, language))

def _process_evaluation(original, translated, language):
    return call_llm(JUDGE_MODEL, _build_evaluation_prompt(original, translated, language))
```

#### –í—ã–¥–µ–ª–µ–Ω—ã –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã

```python
TRANSLATOR_MODEL = "Qwen/Qwen3-VL-30B-A3B-Instruct"
JUDGE_MODEL = "claude-sonnet-4-5-20250929"
API_TIMEOUT = 30
```

#### Logging –≤–º–µ—Å—Ç–æ print()

```python
# –î–û
print("[INFO] –°–æ–æ–±—â–µ–Ω–∏–µ")
print("[ERROR] –û—à–∏–±–∫–∞")

# –ü–û–°–õ–ï
logger.info("–°–æ–æ–±—â–µ–Ω–∏–µ")
logger.error("–û—à–∏–±–∫–∞")
```

---

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è conftest.py

#### –ë—ã–ª–æ
- 267 —Å—Ç—Ä–æ–∫
- –ò–∑–±—ã—Ç–æ—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–±–æ–ª–µ–µ 60% —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ)
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–π

#### –°—Ç–∞–ª–æ
- **108 —Å—Ç—Ä–æ–∫ (-60% —Å—Ç—Ä–æ–∫)**
- –ö—Ä–∞—Ç–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ docstring
- –í—Å–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã –∫–æ–º–ø–∞–∫—Ç–Ω—ã

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

```python
# –î–û: 15 —Å—Ç—Ä–æ–∫ –Ω–∞ –ø—Ä–æ—Å—Ç—É—é —Ñ–∏–∫—Å—Ç—É—Ä—É
@pytest.fixture
def client():
    """
    –§–∏–∫—Å—Ç—É—Ä–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è Flask test client.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é.
    ...–º–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞...
    """
    flask_app.config['TESTING'] = True
    with flask_app.test_client() as test_client:
        yield test_client

# –ü–û–°–õ–ï: 5 —Å—Ç—Ä–æ–∫
@pytest.fixture
def client():
    """Flask test client –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤."""
    flask_app.config['TESTING'] = True
    with flask_app.test_client() as test_client:
        yield test_client
```

---

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ü–æ–∫—Ä—ã—Ç–∏—è –¢–µ—Å—Ç–∞–º–∏

#### –ë—ã–ª–æ
- 45 —Ç–µ—Å—Ç–æ–≤
- 89% –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
- –£–ø—É—â–µ–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### –°—Ç–∞–ª–æ
- **57 —Ç–µ—Å—Ç–æ–≤ (+12 –Ω–æ–≤—ã—Ö, +27%)**
- **97% –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ (+8%)**
- –ü–æ–∫—Ä—ã—Ç—ã –≤—Å–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### –ù–æ–≤—ã–µ –¢–µ—Å—Ç—ã

| –ö–ª–∞—Å—Å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç |
|-------|-----------|---|
| TestHelperFunctions | 6 | –í—Å–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ |
| TestEdgeCases | 4 | –ü–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã, Unicode |
| TestDefaultValues | 2 | –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |

#### –ü—Ä–∏–º–µ—Ä—ã –ù–æ–≤—ã—Ö –¢–µ—Å—Ç–æ–≤

```python
class TestHelperFunctions:
    """–¢–µ—Å—Ç—ã –¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π."""
    
    def test_build_translation_prompt(self):
        from app import _build_translation_prompt
        prompt = _build_translation_prompt("Hello", "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π")
        assert "Hello" in prompt
        assert "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π" in prompt
    
    def test_process_translation_success(self, mock_call_llm):
        from app import _process_translation
        mock_call_llm.return_value = "Bonjour"
        result = _process_translation("Hello", "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π")
        assert result == "Bonjour"

class TestEdgeCases:
    """–¢–µ—Å—Ç—ã –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤."""
    
    def test_post_with_unicode_characters(self, mock_call_llm, client):
        mock_call_llm.return_value = "–ü–µ—Ä–µ–≤–µ–¥–µ–Ω–æ"
        response = client.post("/", data={
            "text": "–ü—Ä–∏–≤–µ—Ç –º–∏—Ä! ‰Ω†Â•Ω‰∏ñÁïå ŸÖÿ±ÿ≠ÿ®ÿß ÿßŸÑÿπÿßŸÑŸÖ",
            "language": "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π"
        })
        assert response.status_code == 200
```

---

### 4. –ú–µ—Ç—Ä–∏–∫–∏ –ö–∞—á–µ—Å—Ç–≤–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|---------|-------|-------|-----------|
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (app.py) | 255 | 139 | **-45%** ‚úÖ |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (conftest.py) | 267 | 108 | **-60%** ‚úÖ |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ | 45 | 57 | **+27%** ‚úÖ |
| –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ | 89% | 97% | **+8%** ‚úÖ |
| –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è | 0.43s | 0.25s | **-42%** ‚úÖ |

---

## üèÜ –õ—É—á—à–∏–µ –ü—Ä–∞–∫—Ç–∏–∫–∏, –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ

### ‚úÖ DRY (Don't Repeat Yourself)
- –ò–∑–≤–ª–µ—á–µ–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
  - `_build_translation_prompt()`
  - `_build_evaluation_prompt()`
  - `_process_translation()`
  - `_process_evaluation()`
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤–º–µ—Å—Ç–æ –∂—ë—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### ‚úÖ KISS (Keep It Simple, Stupid)
- –£–¥–∞–ª–µ–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- –£–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ `process()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è logging –≤–º–µ—Å—Ç–æ print()

### ‚úÖ SRP (Single Responsibility Principle)
- –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–¥–Ω—É –∑–∞–¥–∞—á—É
- `_build_translation_prompt()` —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∏—Ç –ø—Ä–æ–º–ø—Ç
- `_process_translation()` —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä–µ–≤–æ–¥

### ‚úÖ Code Coverage
- –ü–æ–∫—Ä—ã—Ç–∏–µ —É–≤–µ–ª–∏—á–µ–Ω–æ —Å 89% –¥–æ 97%
- –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏ —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è
- –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã

### ‚úÖ Readable Code
- –§—É–Ω–∫—Ü–∏–∏ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏, –≥–æ–≤–æ—Ä—è—â–∏–º–∏ –∏–º–µ–Ω–∞–º–∏
- –ö—Ä–∞—Ç–∫–∏–µ, –Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ docstring
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ print()

---

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –§–∞–π–ª—ã

### ‚úÖ src/app.py
- 45% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ (255 ‚Üí 139)
- 4 –Ω–æ–≤—ã–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –ó–∞–º–µ–Ω–∞ print() –Ω–∞ logging
- –í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç

### ‚úÖ tests/conftest.py
- 60% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ (267 ‚Üí 108)
- –°–æ–∫—Ä–∞—â–µ–Ω—ã docstring'–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

### ‚úÖ tests/test_app.py
- 12 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ (+27%)
- TestHelperFunctions (6 —Ç–µ—Å—Ç–æ–≤)
- TestEdgeCases (4 —Ç–µ—Å—Ç–∞)
- TestDefaultValues (2 —Ç–µ—Å—Ç–∞)

### ‚úÖ README.md
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –°—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç –æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –î–∞–ª—å–Ω–µ–π—à–µ–π –†–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```python
# config.py
API_CONFIG = {
    'endpoint': 'https://api.mentorpiece.org/v1/process-ai-request',
    'timeout': 30,
    'models': {
        'translator': 'Qwen/Qwen3-VL-30B-A3B-Instruct',
        'judge': 'claude-sonnet-4-5-20250929'
    }
}
```

### 2. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–µ—Ä–µ–≤–æ–¥–æ–≤

```python
from functools import lru_cache

@lru_cache(maxsize=128)
def _get_translation_cached(text, language):
    return _process_translation(text, language)
```

### 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –î–∞–Ω–Ω—ã—Ö

```python
logger.info("Translation completed", extra={
    'text_length': len(original_text),
    'language': target_language,
    'duration_ms': elapsed_time
})
```

### 4. –í–∞–ª–∏–¥–∞—Ü–∏—è –í—Ö–æ–¥–Ω—ã—Ö –î–∞–Ω–Ω—ã—Ö

```python
from pydantic import BaseModel, validator

class TranslationRequest(BaseModel):
    text: str
    language: str
    
    @validator('text')
    def text_not_empty(cls, v):
        if not v.strip():
            raise ValueError('Text cannot be empty')
        return v
```

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —É—Å–ø–µ—à–Ω–æ:
- ‚úÖ –°–æ–∫—Ä–∞—Ç–∏–ª –∫–æ–¥ –Ω–∞ 48% –≤ —Å—Ä–µ–¥–Ω–µ–º
- ‚úÖ –£–≤–µ–ª–∏—á–∏–ª –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –Ω–∞ 8%
- ‚úÖ –£—Å–∫–æ—Ä–∏–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ 42%
- ‚úÖ –£–ª—É—á—à–∏–ª —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å
- ‚úÖ –ü—Ä–∏–º–µ–Ω–∏–ª –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ Python

**–ö–æ–¥ —Ç–µ–ø–µ—Ä—å –≥–æ—Ç–æ–≤ –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –ª–µ–≥—á–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ.**

---

**–í–µ—Ä—Å–∏—è:** 1.1  
**–î–∞—Ç–∞:** 16 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–û–ò–ó–í–û–î–°–¢–í–û –ì–û–¢–û–í–û
