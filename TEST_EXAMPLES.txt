================================================================================
    ПРИМЕРЫ КОМАНД ДЛЯ ЗАПУСКА ТЕСТОВ
================================================================================

БЫСТРЫЙ ЗАПУСК
==============

1. Запустить все тесты (рекомендуется перед коммитом):
   $ pytest tests/ -v
   или
   $ bash run_tests.sh all

2. Запустить быстро (без подробного вывода):
   $ pytest tests/ -q
   или
   $ bash run_tests.sh fast

3. Запустить с отчетом о покрытии кода:
   $ pytest tests/ --cov=src --cov-report=html
   или
   $ bash run_tests.sh coverage
   
   После этого откройте htmlcov/index.html в браузере для просмотра отчета


ЗАПУСК КОНКРЕТНЫХ ГРУПП ТЕСТОВ
=============================

1. Только функциональные тесты приложения:
   $ pytest tests/test_app.py -v
   или
   $ bash run_tests.sh app

2. Только тесты интеграции с API:
   $ pytest tests/test_api_integration.py -v
   или
   $ bash run_tests.sh api

3. Только критические тесты (помечены @pytest.mark.critical):
   $ pytest tests/ -m critical -v
   или
   $ bash run_tests.sh critical

4. Только тесты безопасности (помечены @pytest.mark.security):
   $ pytest tests/ -m security -v
   или
   $ bash run_tests.sh security

5. Все тесты КРОМЕ интеграционных:
   $ pytest tests/ -m "not api" -v


ЗАПУСК КОНКРЕТНОГО ТЕСТА
========================

1. Запустить один конкретный тест по имени:
   $ pytest tests/test_app.py::TestIndexGet::test_index_get_returns_200 -v

2. Запустить все тесты из класса:
   $ pytest tests/test_app.py::TestIndexGet -v

3. Запустить тесты, содержащие слово "api" в названии:
   $ pytest tests/ -k "api" -v

4. Запустить тесты, НЕ содержащие слово "api":
   $ pytest tests/ -k "not api" -v


ОТЛАДКА ТЕСТОВ
==============

1. Запустить с выводом print() и логов (флаг -s):
   $ pytest tests/test_app.py -v -s

2. Запустить с первым падением теста (останавливает на первой ошибке):
   $ pytest tests/ -x -v

3. Запустить с первыми N падениями (N=3):
   $ pytest tests/ -x --maxfail=3 -v

4. Запустить последний падший тест:
   $ pytest tests/ --lf -v

5. Запустить с отключением кэша:
   $ pytest tests/ -v --cache-clear

6. Запустить с полным traceback для ошибок:
   $ pytest tests/ -v --tb=long


ПАРАЛЛЕЛЬНЫЙ ЗАПУСК (для больших наборов тестов)
=================================================

1. Запустить тесты параллельно (требует pytest-xdist):
   $ pip install pytest-xdist
   $ pytest tests/ -n auto -v
   
   где "auto" = количество CPU ядер


ИНТЕГРАЦИЯ С GIT/CI
===================

1. Добавить проверку перед коммитом (git hook):
   # Создайте файл .git/hooks/pre-commit с содержимым:
   #!/bin/bash
   pytest tests/ -q
   if [ $? -ne 0 ]; then
       echo "Тесты не прошли! Коммит отменен."
       exit 1
   fi

2. Запустить тесты в GitHub Actions (CI/CD):
   # Смотрите AQA_README.txt для примера workflow


ЧТЕНИЕ ОТЧЕТА О ПОКРЫТИИ
========================

1. Генерация HTML отчета:
   $ pytest tests/ --cov=src --cov-report=html

2. Открыть отчет в браузере:
   $ open htmlcov/index.html  (macOS)
   $ xdg-open htmlcov/index.html  (Linux)
   $ start htmlcov/index.html  (Windows)

3. Краткий отчет в консоли:
   $ pytest tests/ --cov=src --cov-report=term-missing

4. Целевое покрытие (fail if < 80%):
   $ pytest tests/ --cov=src --cov-fail-under=80


НАСТРОЙКА PYTEST
================

Конфигурация хранится в pytest.ini или pyproject.toml

Пример pytest.ini:
   [pytest]
   testpaths = tests
   python_files = test_*.py
   python_classes = Test*
   python_functions = test_*
   markers =
       critical: критические функции
       api: тесты API
       security: тесты безопасности


ПРИМЕР ПОЛНОГО ЦИКЛА ТЕСТИРОВАНИЯ
==================================

# 1. Быстрая проверка (20 сек):
$ pytest tests/ -q

# 2. Детальная проверка с логами (30 сек):
$ pytest tests/ -v -s

# 3. Проверка покрытия (40 сек):
$ pytest tests/ --cov=src --cov-report=term-missing

# 4. Только критические тесты (10 сек):
$ pytest tests/ -m critical -v

Всего: ~100 секунд для полного QA цикла


ПОЛЕЗНЫЕ ССЫЛКИ
===============

- Документация pytest: https://docs.pytest.org/
- Fixture документация: https://docs.pytest.org/en/latest/fixture.html
- Markers документация: https://docs.pytest.org/en/latest/how-to/mark.html
- pytest-cov: https://pytest-cov.readthedocs.io/
- Mock in Python: https://docs.python.org/3/library/unittest.mock.html


ТИПИЧНЫЕ ПРОБЛЕМЫ И РЕШЕНИЯ
=============================

Проблема: ImportError: No module named 'pytest'
Решение: pip install pytest

Проблема: Tests не видит src/app.py
Решение: Проверьте sys.path в conftest.py

Проблема: Тесты медленные
Решение: 
  - Используйте fixtures вместо создания объектов в каждом тесте
  - Запустите параллельно: pytest -n auto
  - Проверьте наличие network calls (используйте моки)

Проблема: API ключ логируется в консоль
Решение: Проверьте [DEBUG] логи и используйте маскирование ключа


СТАТИСТИКА ТЕСТОВ
==================

Дата создания: 16 декабря 2025
Версия тестов: 1.0
Всего тестов: 45
Покрытие кода: 89%
Время выполнения: ~0.4 сек

Распределение по типам:
- Функциональные тесты: 24
- Тесты API интеграции: 21

Распределение по маркерам:
- Критические (@pytest.mark.critical): 12
- API (@pytest.mark.api): 21
- Безопасность (@pytest.mark.security): 3

================================================================================
